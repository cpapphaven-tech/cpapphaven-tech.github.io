<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Early Tracking Script -->
    <script>
        (function () {
            const startTime = Date.now();
            const anonKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJqcGdvdmZ6b25sbWpycnVhc3BwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyNjA0MDQsImV4cCI6MjA4NTgzNjQwNH0.fwBaiOgXtnQVgq0IOdPmOskQHDqgOWWqr0mm3PSu57I";
            const endpoint = "https://bjpgovfzonlmjrruaspp.supabase.co/functions/v1/collect";

            const urlParams = new URLSearchParams(window.location.search);
            const placementId = urlParams.get('utm_content') || urlParams.get('placementid');

            const hitData = {
                timestamp: new Date(Date.now() + 19800000).toISOString().replace('Z', '+05:30'),
                url: location.href,
                referrer: document.referrer,
                userAgent: navigator.userAgent,
                screen: { width: screen.width, height: screen.height },
                loadStage: "pre-init",
                placement_id: placementId
            };

            const sendHit = (stage) => {
                hitData.loadStage = stage;
                hitData.timestamp = new Date(Date.now() + 19800000).toISOString().replace('Z', '+05:30');

                if (stage === "early-exit") {
                    hitData.duration_seconds = Math.round((Date.now() - startTime) / 1000);
                }

                fetch(endpoint, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "apikey": anonKey,
                        "Authorization": "Bearer " + anonKey
                    },
                    body: JSON.stringify(hitData),
                    keepalive: true
                });
            };

            sendHit("pre-init");

            window.addEventListener("pagehide", function () {
                if (!window.FIREBASE_INITIALIZED) {
                    sendHit("early-exit");
                }
            });
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ludo Master - Play with AI | PlayMixGames</title>
    <meta name="description"
        content="Play classic Ludo online. Challenge smart AI opponents in this strategic board game. Roll the dice, race your tokens, and become the Ludo Master!">
    <link rel="stylesheet" href="style.css">

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6129521314653726"
        crossorigin="anonymous"></script>

    <script type="module" src="../analytics.js"></script>
    <script src="../ads.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // loadSocialBarAd();
            if (typeof renderTopRightScroller === 'function') {
                renderTopRightScroller();
            }
        });
    </script>
</head>

<body>
    <!-- Header -->
    <header>
        <a href="../index.html" class="back-btn">‚Üê PlayMixGames</a>
        <h1 class="game-title">LUDO MASTER</h1>
        <div class="level-display" id="turn-display">
            TURN: RED
        </div>
    </header>

    <!-- RIGHT SIDE ADSTERRA BANNER (Desktop Only) -->
    <div id="adsterra-banner">
        <!-- Script will be injected here by game.js after 2s -->
    </div>

    <!-- Game Container -->
    <div id="game-container">

        <!-- The Board -->
        <div id="ludo-board">
            <!-- Grid generated by JS -->
        </div>

        <!-- Controls Bottom -->
        <div id="controls-area">
            <!-- Dice Button -->
            <div id="dice-btn" class="dice-container">
                üé≤
            </div>
            <div id="message-area">
                Roll to Start!
            </div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="overlay-screen" style="z-index: 2500;">
            <div class="screen-content">
                <h1 style="color: var(--ludo-yellow); font-size: 2rem; margin-bottom: 10px;">LUDO MASTER</h1>
                <p style="color: #ccc; margin-bottom: 20px;">Choose Your Game Mode</p>

                <button id="mode-2p" class="game-btn"
                    style="background: linear-gradient(135deg, #FF4136, #FFDC00); width: 100%;">
                    VS Computer (2 Players)
                </button>

                <button id="mode-4p" class="game-btn"
                    style="background: linear-gradient(135deg, #2ECC40, #0074D9); width: 100%;">
                    VS Computer (4 Players)
                </button>
            </div>
        </div>

        <!-- Win Screen -->
        <div id="level-complete-screen" class="overlay-screen hidden">
            <div class="screen-content">
                <h1 id="winner-text" style="color: var(--ludo-green); font-size: 2rem; margin-bottom: 10px;">YOU WON!
                </h1>
                <div style="font-size: 4rem; margin-bottom: 20px;">üèÜ</div>
                <button id="restart-btn" class="game-btn">
                    Play Again
                </button>
            </div>
        </div>

    </div>

    <!-- Bottom Banner Ad -->
    <div id="bottom-ad">
        <script>
            (function () {

                const container = document.getElementById("bottom-ad");

                function loadBanner() {
                    if (typeof shouldLoadAds === "function" && !shouldLoadAds()) {
                        console.log("üöß [ADS] Banner skipped");
                        return;
                    }

                    if (!container) return;

                    // Create inner ad wrapper (safe clear)
                    container.innerHTML = '<div id="banner-slot"></div>';
                    const slot = document.getElementById("banner-slot");

                    window.atOptions = {
                        key: "de617c07128b585ef939154460e6858f",
                        format: "iframe",
                        height: 50,
                        width: 320,
                        params: {}
                    };

                    const s = document.createElement("script");
                    s.src = "https://www.highperformanceformat.com/de617c07128b585ef939154460e6858f/invoke.js";
                    slot.appendChild(s);

                }

                if (window.DEV_MODE) {
                    return;
                }
                // Initial load
                setTimeout(loadBanner, 100);



            })();
        </script>
    </div>

    <!-- SEO: About Game & How to Play Section -->
    <section id="game-info" style="background: #f8f9fa; padding: 40px 20px; margin-top: 40px; text-align: center;">
        <div style="max-width: 900px; margin: 0 auto;">
            <h2 style="font-size: 2rem; color: #333; margin-bottom: 20px;">üé≤ About Ludo Master</h2>
            <p style="font-size: 1.1rem; color: #555; line-height: 1.6; margin-bottom: 30px;">
                Ludo Master is the digital version of the classic Indian board game Ludo. Race your tokens around the
                board to reach home first
                while strategically moving, blocking, and eliminating your opponents. Play against AI players with
                varying difficulty levels
                or challenge friends in this timeless game of strategy, luck, and tactical skill.
            </p>

            <h3 style="font-size: 1.5rem; color: #333; margin-bottom: 15px;">üéÆ How to Play</h3>
            <ul
                style="font-size: 1rem; color: #555; text-align: left; display: inline-block; line-height: 2; margin-bottom: 60px;">
                <li>‚úÖ Roll the dice to move your tokens</li>
                <li>‚úÖ Roll a 6 to bring a token out of home</li>
                <li>‚úÖ Move your tokens around the board path</li>
                <li>‚úÖ Capture opponent tokens by landing on them</li>
                <li>‚úÖ Get all your tokens home to win the game</li>
            </ul>
        </div>
    </section>

    <script src="game.js"></script>
</body>

</html>